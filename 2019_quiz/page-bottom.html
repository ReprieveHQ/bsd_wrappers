<div class='fieldset optinradio_fieldset'><label class='optin_lang'>Would you like to receive updates about our news, campaigns and appeals by email? <a href='http://www.reprieve.org.uk/privacy/' target='_blank'>(see our privacy policy)</a></label>
  <label for='optin_1'><input id='optin_1' class='optinradio' name='optin' value='Yes' type='radio'>Yes</label>
  <label for='optin_0'><input id='optin_0' class='optinradio' name='optin' value='No' type='radio'>No</label>
  <p id='optin_warning'>Don't want to hear from us? If you're already on our mailing list, selecting this option may unsubscribe you from our alerts.</p>
</div>
</div>
</div>
</div>
</div>

<div class="slide13 slide darkslide shareslide" style="display: none;">
  <div class="container">
    <div class="row">
      <div class="col-md">
        <!-- TODO: Edit text above share buttons below. Place to edit Twitter and Facebook text itself is further down. -->
        <h2>Thank you, <span class="first_name">supporter</span> for signing the petition</h2>
        <h4>Can you help us by sharing the petition?</h4>
        <button class="solid button facebook_share" onclick="return submitAndShare();">Share on Facebook</button> <button class="solid button twitter_share">Share on Twitter
        </button><button class="button outline" id="slide2_skip">Skip</button>
      </div>
    </div>
  </div>
</div>


<div class="slide14 slide darkslide donateslide" style="display: none;">
  <div class="container">
    <div class="row">
      <div class="col-md">
        <!-- TODO: Add text to convince people to donate below! You may not need three lines, so feel free to delete the <p></p> section if not. -->
        <div class="unsigned">
          <h2>Can you help make our life-saving work possible?</h2>
          <p>We fund the litigation, expert witnesses and investigations which help to deliver justice and save lives across the globe.</p>
          <p>Can you make a donation today so we can continue to help victims of injustice?</p>

        </div>

        <!-- TODO: Change URLs below to URL of relevant donation page. PLEASE rememember to create a source code. -->

        <div class="donate-tab-container">
          <div class="donate-tab-top clearfix">
            <div class="donate-tab-gm donate-tab picked-tab">
              <h2>Give Monthly</h2>
            </div>
            <div class="donate-tab-gn donate-tab">
              <h2>Give Now</h2>
            </div>
          </div>
          <div class="donate-tab-main clearfix">
            <div class="donate-tab-givemonthly donate-tab-body picked-body">
              <p>Giving monthly helps us fund long-term projects and cases.</p>
              <a class="button solid small donateButton donateMButton" href="https://secure.edirectdebit.com/Reprieve/Donate4/?ref=joinemaildmslide&amount=5">£5</button>
                <a class="button solid small donateButton donateMButton" href="https://secure.edirectdebit.com/Reprieve/Donate4/?ref=joinemaildmslide&amount=10">£10</button>
                  <a class="button solid small donateButton donateMButton" href="https://secure.edirectdebit.com/Reprieve/Donate4/?ref=joinemaildmslide&amount=15">£15</button>
                    <a class="button outline small donateButton donateMButton" href="https://secure.edirectdebit.com/Reprieve/Donate4/?ref=joinemaildmslide">Other</button>
            </div>
            <div class="donate-tab-givenow donate-tab-body">
              <p>Give an individual donation now to fund our most urgent cases.</p>
              <a class="button solid small donateButton donateNButton" href="https://act.reprieve.org.uk/page/contribute/email-thank-you?source=joinemaildnslide&default_amt=15">£15</button>
                <a class="button solid small donateButton donateNButton" href="https://act.reprieve.org.uk/page/contribute/email-thank-you?source=joinemaildnslide&default_amt=25">£25</button>
                  <a class="button solid small donateButton donateNButton" href="https://act.reprieve.org.uk/page/contribute/email-thank-you?source=joinemaildnslide&default_amt=50">£50</button>
                    <a class="button outline small donateButton donateNButton" href="https://act.reprieve.org.uk/page/contribute/email-thank-you?source=joinemaildnslide">Other</button>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>

</div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.3/jquery.min.js"></script>
<script type="text/javascript" async src="https://platform.twitter.com/widgets.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.17.0/jquery.validate.min.js"></script>
<script>
  // Progress bar

  jQuery(document).ready(function($) {

    // Set country from parameter

    // Construct URL object using current browser URL
    var url = new URL(document.location);

    // Get query parameters object
    var params = url.searchParams;

    // Get value of country
    var countryurl = params.get("country");

    if (countryurl === null) {
      $("#country").val("GB");
    } else if (countryurl === "US") {
      $("#country").val(countryurl);
      $(".usdonate").show();
      $(".ukdonate").hide();
    } else {
      $("#country").val(countryurl);
    }

    // US Donate

    var optionSelected = $("#country option:selected").val();

    $("#country").on("change", function(e) {
      console.log("CHANGE IS A-COMING!");
      var optionSelected = $("#country option:selected").val();
      if (optionSelected === "US") {
        $(".usdonate").show();
        $(".ukdonate").hide();
      } else {
        $(".usdonate").hide();
        $(".ukdonate").show();
      }
    });

    function count_signups(signup_form_id) {

      // This function formats numbers by adding commas
      function numberFormat(nStr, prefix) {
        var prefix = prefix || '';
        nStr += '';
        x = nStr.split('.');
        x1 = x[0];
        x2 = x.length > 1 ? '.' + x[1] : '';
        var rgx = /(\d+)(\d{3})/;
        while (rgx.test(x1))
          x1 = x1.replace(rgx, '$1' + ',' + '$2');
        return prefix + x1 + x2;
      }

      function load_counter(data) {
        var cumulativeNum = data * 1;

        console.log(cumulativeNum)

        cumulativeNum += 17369; // accounting for offline action

        console.log(cumulativeNum)

        var signups = numberFormat(cumulativeNum);

        var signupsnum = signups.replace(",", "");

        var signupstotal = signupsnum;

        var target = 40000;

        var percentageComplete = (signupstotal / target) * 100;

        $(".totalLevel").css("width", percentageComplete + "%");

        $('.amount').text(signups);

        $('.goal').text("40,000");

        $(".goal-progress").addClass('js-percent');

        var getPercent = percentageComplete;
        var getProgressWrapWidth = $('.js-percent .progress-wrp').width();
        var progressTotal = percentageComplete + "%";
        var animationLength = 2500;

        // on page load, animate percentage bar to data percentage length
        // .stop() used to prevent animation queueing
        $('.js-percent .progress-bar').stop().animate({
          left: progressTotal
        }, animationLength);
        var numTruncated = parseFloat(percentageComplete).toFixed(2);
        $('.js-percent .percentage-number').text(numTruncated + "%");
        $(".goal-progress").removeClass('js-percent');

      }

      bQuery.get("/utils/cons_counter/signup_counter.ajax.php?signup_form_id=170", load_counter);
    }



    count_signups();



  });

  // SHARING

  jQuery('.twitter_share').click(function(e) {
    var currentUrl = encodeURIComponent(getPathFromUrl(window.location.href));
    // <!-- TODO: Insert Tweet text below! -->
    var tweet = encodeURIComponent(
      "UK Torture - the government is rewriting our country’s torture rules in secret. I'm calling for an open and transparent process to put an end to UK torture complicity. Add your name now! #EndUKTorture");
    var space = encodeURIComponent(" ");
    window.open("https://twitter.com/intent/tweet?text=" + tweet + space + currentUrl, "_blank", "toolbar=no,scrollbars=no,resizable=yes,width=560,height=560");
    nextSlide('.slide2');
    // initSlider();
  });

  jQuery('#slide2_skip').click(function() {
    nextSlide('.slide2');
  });

  function submitAndShare() {

    var firstname = $("#firstname").val();

    // <!-- TODO: Insert Facebook Title and Description below -->

    var title = 'The UK government is secretly rewriting the rules on torture: Join ' + firstname + ' and sign petition now!';
    var description = 'We are calling for an open and transparent process to put an end to UK torture complicity.';

    shareOverrideOGMeta(window.location.href,
      title,
      description);

    nextSlide('.slide2');


    return false;


  }

  function shareOverrideOGMeta(overrideLink, overrideTitle, overrideDescription) {
    FB.ui({
        method: 'share_open_graph',
        action_type: 'og.shares',
        action_properties: JSON.stringify({
          object: {
            'og:url': overrideLink,
            'og:title': overrideTitle,
            'og:description': overrideDescription,
            // <!-- TODO: Insert Facebook image link below -->
            'og:image': 'https://FACEBOOKIMAGE.png'

          }
        })
      },
      function(response) {
        // Action after response
      });
  }

  function shareOriginal() {
    FB.ui({
        method: 'share',
        href: window.location.href
      },
      function(response) {
        // Action after response
      });

    return false;
  }
</script>
